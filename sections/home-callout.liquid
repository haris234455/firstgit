{%- assign fields = section.settings -%}

{%- assign mod_image_desktop = fields['image_desktop'] | img_url: '2160x' -%}
{%- assign mod_image_text = fields['image_desktop'].alt -%}

{%- capture mod_image_src_media -%}
  <source media="(max-width: 599px)" data-srcset="{{- fields['image_mobile'] | img_url: '900x' -}}">
  <source media="(min-width: 600px) and (max-width: 999px)" data-srcset="{{- fields['image_intermediate'] | img_url: '1200x' -}}">
  <source media="(min-width: 1000px)" data-srcset="{{- mod_image_desktop -}}">
{%- endcapture -%}

{%- include 'callout',
  mod_text: fields['text'],
  mod_cta_text: fields['cta_text'],
  mod_cta_url: fields['cta_url'],
  mod_background: fields['background'],
  mod_image_src: mod_image_desktop,
  mod_image_text: mod_image_text,
  mod_image_src_media: mod_image_src_media,
  mod_video_url: fields['video_url'],
  mod_video_intermediate_url: fields['video_intermediate_url'],
  mod_video_mobile_url: fields['video_mobile_url'] -%}

{%- assign fields = nil -%}
{%- assign mod_image_desktop = nil -%}
{%- assign mod_image_text = nil -%}
{%- assign mod_image_src_media = nil -%}

{% schema %}
  {
    "name": "Home Callout",
    "settings": [{
      "type": "header",
      "content": "Content"
    }, {
      "type": "textarea",
      "id": "text",
      "label": "Text"
    }, {
      "type": "text",
      "id": "cta_text",
      "label": "CTA Text"
    }, {
      "type": "url",
      "id": "cta_url",
      "label": "CTA URL"
    }, {
      "type": "header",
      "content": "Style"
    }, {
      "type": "select",
      "id": "background",
      "label": "Select the background asset to use for the hero",
      "options": [{
        "value": "image",
        "label": "Image"
      }, {
        "value": "video",
        "label": "Video"
      }],
      "default": "image"
    }, {
      "type": "header",
      "content": "Background Image"
    }, {
      "type": "image_picker",
      "id": "image_desktop",
      "label": "Image Desktop",
      "info": "Upload JPEG ~ 2160x435px"
    }, {
      "type": "image_picker",
      "id": "image_intermediate",
      "label": "Image Intermediate",
      "info": "Upload JPEG ~ 1200x375px"
    }, {
      "type": "image_picker",
      "id": "image_mobile",
      "label": "Image Mobile",
      "info": "Upload JPEG ~ 900x255px"
    }, {
      "type": "header",
      "content": "Background Video"
    }, {
      "type": "text",
      "id": "video_url",
      "label": "Video URL Desktop",
      "info": "Enter the video file URL hosted on your Vimeo PRO Account"
    }, {
      "type": "text",
      "id": "video_intermediate_url",
      "label": "Video URL Intermediate",
      "info": "Enter the video file URL hosted on your Vimeo PRO Account"
    }, {
      "type": "text",
      "id": "video_mobile_url",
      "label": "Video URL Mobile",
      "info": "Enter the video file URL hosted on your Vimeo PRO Account"
    }]
  }
{% endschema %}
