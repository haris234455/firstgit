{% for block in section.blocks %}
  {% assign item = block.settings %}

  {% assign enable = item['enable'] %}
  {% assign title = item['title'] %}
  {% assign target = item['target'] %}
  {% assign script = item['script'] %}

  {% if target == blank and enable %}
    {{ script }}
  {% elsif target == page.handle and enable %}
    {{ script }}
  {% endif %}

  {% assign enable = false %}
  {% assign title = false %}
  {% assign target = false %}
  {% assign script = false %}
{% endfor %}

{% schema %}
  {
    "name": "OptinMonster Campaigns",
    "blocks": [ {
      "type": "email-signup",
      "name": "Email Signup",
      "settings": [ {
        "type": "text",
        "id": "title",
        "label": "Title"
      }, {
        "type": "page",
        "id": "target",
        "label": "Page"
      }, {
        "type": "html",
        "id": "script",
        "label": "Script"
      }, {
        "type": "checkbox",
        "id": "enable",
        "label": "Enable Campaign",
        "default": true
      } ]
    } ]
  }
{% endschema %}
