{%- assign fields = section.settings -%}

{%- assign mod_limit = 12 -%}
{%- assign mod_collection = fields['featured_collection'] -%}

{%- capture mod_handles -%}
  {%- for product in collections[mod_collection].products limit: mod_limit -%}
  {{- product.handle -}}{%- unless forloop.last -%},{%- endunless -%}
  {%- endfor -%}
{%- endcapture -%}

{%- include 'product-four-up',
  mod_handles: mod_handles,
  mod_title: fields['title'] -%}

{%- assign fields = nil -%}
{%- assign mod_handles = nil -%}
{%- assign mod_limit = nil -%}
{%- assign mod_collection = nil -%}

{% schema %}
  {
    "name": "Home Product Carousel",
    "settings": [{
      "type": "header",
      "content": "Content"
    }, {
      "type": "text",
      "id": "title",
      "label": "Title"
    }, {
      "type": "collection",
      "id": "featured_collection",
      "label": "Featured Collection"
    }]
  }
{% endschema %}
